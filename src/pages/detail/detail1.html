<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>商品详情</title>
    <link rel="stylesheet" type="text/css" href="../../styles/pages/detail/detail1.css" />
</head>

<body>
    <!-- 头部 -->
    <div class="outheader">
        <div class="head">
            <span>1件包邮</span>
            <ul>
                <li class="index_login">
                    <i></i>
                    <a href="../login/login.html">登录</a>
                    <a href="../regist/regist.html">注册</a>
                    <span>退出</span>
                </li>
                <li class="index_search">
                    <span><img src="../../img/index/放大镜.png"></span>
                    <i>搜索</i>
                    <div>
                        <input type="text" placeholder="想找什么随便搜...">
                        <label></label>
                        <span>搜索</span>
                    </div>
                </li>

                <li class="specialCart" style="color:#ff0000">
                    <span><img src="../../img/index/购物车.png"></span>
                    购物车<i>0</i>件
                </li>
                <li>
                    <span><img src="../../img/index/订单.png"></span>
                    我的订单
                </li>
                <li>
                    <span><img src="../../img/index/客服.png"></span>
                    客服热线
                </li>
                <li>
                    关注ONLY微信
                    <dl class="wechatCode" style="z-index:10000">
                        <dt>
                            <img src="../../img/index/code1.png" </dt> <dd>
                            微信扫一扫关注<br>第一时间了解品牌咨询
                            </dd>
                    </dl>
                </li>
                <li>
                    专属导购
                    <dl class="shopCode">
                        <dt>
                            <img src="../../img/index/code2.jpg" </dt> <dd>
                            微信扫一扫<br>添加您专属的时尚导购
                            </dd>
                    </dl>
                </li>
                <li>
                    手机购物
                    <dl class="phoneCode">
                        <dt>
                            <img src="../../img/index/code3.png" </dt> <dd>
                            微信扫一扫购物<br>众多潮流单品住您焕新造型
                            </dd>
                    </dl>
                </li>
            </ul>
        </div>
    </div>

    <!-- 导航栏 -->
    <div class="outnav">
        <div class="nav">
            <a href="../index/index.html"><img src="../../img/index/logo.png"></a>
            <ul>
                <li><a href="../index/index.html">首页</a></li>
                <li>
                    <a href="../list/list1.html">所有商品</a>
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">裙装</a></h3>
                            <li><a href="">连衣裙</a></li>
                            <li><a href="">半身裙</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">裤装</a></h3>
                            <li><a href="">牛仔裤</a></li>
                            <li><a href="">休闲裤</a></li>
                            <li><a href="">背带/连体裤</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">上装</a></h3>
                            <li><a href="">针织衫</a></li>
                            <li><a href="">卫衣</a></li>
                            <li><a href="">衬衫</a></li>
                            <li><a href="">T恤</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">外套</a></h3>
                            <li><a href="">风衣/外套</a></li>
                            <li><a href="">短款外套</a></li>
                            <li><a href="">毛呢大衣</a></li>
                            <li><a href="">西服/西装</a></li>
                        </ul>
                        <img src="../../img/index/nav1.jpg">
                    </div>
                </li>
                <li>
                    <a href="../list/list1.html">热销推荐</a>
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">仙气连衣裙</a></h3>
                            <li><a href="">雪纺连衣裙</a></li>
                            <li><a href="">修身连衣裙</a></li>
                            <li><a href="">多件套连衣裙</a></li>
                            <li><a href="">针织连衣裙</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">潮流T恤</a></h3>
                            <li><a href="">长袖T恤</a></li>
                            <li><a href="">宽松T恤</a></li>
                            <li><a href="">修身T恤</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">酷感皮衣</a></h3>
                            <li><a href="">短款皮衣</a></li>
                            <li><a href="">中长款皮衣</a></li>
                            <li><a href="">皮裙/皮裤</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">气质衬衫</a></h3>
                            <li><a href="">中长袖衬衫</a></li>
                            <li><a href="">蕾丝/雪纺</a></li>
                            <li><a href="">短袖衬衫</a></li>
                        </ul>
                        <img src="../../img/index/nav2.jpg">
                    </div>
                </li>
                <li>
                    夏日新品
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">2019全部新品</a></h3>
                            <li><a href="">全部新品</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">新品到店</a></h3>
                            <li><a href="">5月14日到店</a></li>
                            <li><a href="">5月10日到店</a></li>
                            <li><a href="">5月7日到店</a></li>
                            <li><a href="">4月23日到店</a></li>
                            <li><a href="">4月16日到店</a></li>
                            <li><a href="">4月12日到店</a></li>
                        </ul>
                        <img src="../../img/index/nav3.jpg">
                    </div>
                </li>
                <li>
                    <a href="../list/list2.html">性感家居</a>
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">家居上装</a></h3>
                            <li><a href="">吊带背心</a></li>
                            <li><a href="">家具T恤</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">家居下装</a></h3>
                            <li><a href="">家居休闲裤</a></li>
                        </ul>
                        <img src="../../img/index/nav4.jpg">
                    </div>
                </li>
                <li>
                    <a href="../list/list3.html">ONLYPLAY</a>
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">全部产品</a></h3>
                            <li><a href="">全部</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">运动上装</a></h3>
                            <li><a href="">运动文胸</a></li>
                            <li><a href="">运动背心</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">运动下装</a></h3>
                            <li><a href="">运动短裤</a></li>
                            <li><a href="">运动长裤</a></li>
                        </ul>
                        <img src="../../img/index/nav5.jpg">
                    </div>
                </li>
                <li>
                    <a href="../list/list4.html">漫威合作款</a>
                </li>
                <li>
                    线上专享区
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">全部专项款</a></h3>
                            <li><a href="">5折专区</a></li>
                            <li><a href="">7折专区</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">5折上装</a></h3>
                            <li><a href="">5折风衣/外套</a></li>
                            <li><a href="">5折针织衫</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">5折裤装</a></h3>
                            <li><a href="">5折休闲裤</a></li>
                            <li><a href="">5折牛仔裤</a></li>
                        </ul>
                        <ul>
                            <h3><a href="">5折裙装</a></h3>
                            <li><a href="">5折连衣裙</a></li>
                        </ul>
                        <img src="../../img/index/nav6.jpg">
                    </div>
                </li>
                <li>
                    爱消除联名款
                    <div class="secondNav">
                        <ul>
                            <h3><a href="">全部T恤</a></h3>
                        </ul>
                        <img src="../../img/index/nav7.jpg">
                    </div>
                </li>
                <li>会员中心</li>
            </ul>
        </div>
    </div>

    <!-- 商品详情页标题 -->
    <div class="detail_main_title">
        <span>
            首页/性感家居/系带宽松垂感风衣外套
        </span>
    </div>

    <!-- 商品详情主版块头部 -->
    <div class="detail_main_top">
        <div class="detail_main_top_left">
            <ul class="magnifier_sm">
            </ul>
            <div class="magnifier_big">
                <!-- <img src="../../img/detail/big1.jpg"> -->
                <div class="magnifie_move">
                    <!-- 小放大镜 -->
                </div>
                <span class="magnifier_showpic">
                    <!-- <img src="../../img/detail/big1.jpg"> -->
                </span>
            </div>
            <div class="detail_goodsInfo">
                <div class="goodsPrice">
                    <p class="priceline">
                    </p>
                    <p class="activeline">
                        <span class="active_title">本店活动</span>
                        <span class="active_all">满一件，包邮</span>
                    </p>
                </div>
                <div class="goodsSizeList">
                    <h4>尺码</h4>
                    <ul>
                        <li class="chooseLogo">155/76A/XS</li>
                        <li>160/80A/S</li>
                        <li>165/84A/M</li>
                        <li>170/88A/L</li>
                        <li>175/92A/XL</li>
                    </ul>
                </div>
                <div class="goodsColor">
                    <h4>颜色</h4>
                    <ul>
                    </ul>
                </div>
                <div class="goodsCount">
                    <h4>数量</h4>
                    <div>
                        <i>1</i>
                        <div>
                            <span>+</span>
                            <span>-</span>
                        </div>
                    </div>
                    <p>库存: <i>10</i> 件</p>
                </div>
                <div class="goodsChoose_btn">
                    <span class="join_cart">加入购物车</span>
                    <span class="now_buy">立即购买</span>
                </div>
            </div>
        </div>

        <div class="detail_main_top_right">
            <h3>---热销推荐---</h3>
            <ul>
                <li>
                    <a href="../detail/detail1.html?design=119201660S02"><img src="../../img/detail/hotsale1.jpg"></a>
                    <span>￥229</span>
                </li>
                <li>
                    <a href="../detail/detail1.html?design=119161525S01"><img src="../../img/detail/hotsale2.jpg"></a>
                    <span>￥149</span>
                </li>
                <li>
                    <a href="../detail/detail1.html?design=119107703D09"><img src="../../img/detail/hotsale3.jpg"></a>
                    <span>￥449</span>
                </li>
            </ul>
        </div>
    </div>


    <!-- 商品详情图片信息 -->
    <div class="detail_main_body">
        <div class="detail_body_list">
            <!-- 商品列表JSON渲染 -->
            <ul class="detail_goodslist">
            </ul>
        </div>
        <div class="detail_body_middle">
            <!-- <div>
                <img src="../../img/detail/detail1.jpg">
            </div>  -->
        </div>
        <div class="detail_body_right">
            <h3>---猜你喜欢---</h3>
            <ul>
                <!-- <li>
                    <a href=""><img src="../../img/detail/hotsale1.jpg"></a>
                    <span>￥229</span>
                </li>
                <li>
                    <a href=""><img src="../../img/detail/hotsale2.jpg"></a>
                    <span>￥149</span>
                </li>
                <li>
                    <a href=""><img src="../../img/detail/hotsale3.jpg"></a>
                    <span>￥449</span>
                </li> -->
            </ul>
        </div>
    </div>

    <!-- 尾部 -->
    <div class="outfoot">
        <div class="foot">
            <div class="foot_accect">
                <dl>
                    <dt><img src="../../img/index/accect.png"></dt>
                    <dd>用户服务协议</dd>
                </dl>
                <button>点击查看</button>
            </div>
            <div class="foot_line"></div>
            <div class="foot_code">
                <dl>
                    <dt><img src="../../img/index/code2.jpg"></dt>
                    <dd>专属时尚顾问</dd>
                </dl>
                <dl>
                    <dt><img src="../../img/index/code3.png"></dt>
                    <dd>小程序</dd>
                </dl>
                <dl>
                    <dt><img src="../../img/index/code1.png"></dt>
                    <dd>官方微信</dd>
                </dl>
            </div>
            <div class="foot_line"></div>
            <div class="foot_phone">
                <dl>
                    <dt><img src="../../img/index/phone.png"></dt>
                    <dd>
                        售后服务热线<br>400-862-8888<br>服务时间：9:00-21:00
                    </dd>
                </dl>
            </div>
        </div>
    </div>

    <!-- 在线答疑 -->
    <div class="service">
        <a href="">在线客服 即时答疑 <img src="../../img/index/service.png"> 服务时间（工作日9:00-24:00）</a>
    </div>

    <!-- 其他商标 -->
    <div class="otherBrands">
        <ul>
            <li><img src="../../img/index/logo_footer1.png"></li>
            <li><img src="../../img/index/logo_footer2.png"></li>
            <li style="margin-right:0"><img src="../../img/index/logo_footer3.png"></li>
        </ul>
    </div>

    <!-- 版权 -->
    <div class="banquan">
        © 2013 Bestseller. All Rights Reserved<br>津ICP备12007886号 -3（营业执照）
    </div>
</body>
<script src="../../static/script/require.js" data-main="detail1.js" type="text/javascript"></script>
<script src="../../scripts/libs/jquery-2.0.3.js"></script>
<script>

    // 放大镜
    $(".magnifier_big").mouseover(function () {
        $(".magnifie_move").show()
        $(".magnifier_showpic").show()
    })
    $(".magnifier_big").mouseout(function () {
        $(".magnifie_move").hide()
        $(".magnifier_showpic").hide()
    })

    $(".magnifier_big").mousemove(function (e) {
        var l = e.pageX - $(".magnifier_big").offset().left - ($(".magnifie_move").width() / 2)
        var t = e.pageY - $(".magnifier_big").offset().top - ($(".magnifie_move").height() / 2)
        if (l < 0) {
            l = 0
        }
        if (l > $(this).width() - $(".magnifie_move").width()) {
            l = $(this).width() - $(".magnifie_move").width()
        }
        if (t < 0) {
            t = 0
        }
        if (t > $(this).height() - $(".magnifie_move").height()) {
            t = $(this).height() - $(".magnifie_move").height()
        }

        $(".magnifie_move").css({
            "left": l,
            "top": t
        })
        var pX = l / ($(".magnifier_big").width() - $(".magnifie_move").width())
        var pY = t / ($(".magnifier_big").height() - $(".magnifie_move").height())
        // console.log(pX,pY)
        $(".magnifier_showpic img").css({
            "left": -pX * ($(".magnifier_showpic img").width() - $(".magnifier_showpic").width()),
            "top": -pY * ($(".magnifier_showpic img").height() - $(".magnifier_showpic").height())
        })



    })

    // 商品数量加减
    // $(".goodsCount span").first().click(function () {
    //     var _count = parseInt($(".goodsCount div>i").text());
    //     if (_count < 10)
    //         _count++;
    //     $(".goodsCount div>i").text(_count)
    // }).siblings().click(function () {
    //     var _count = parseInt($(".goodsCount div>i").text());
    //     if (_count > 1)
    //         _count--;
    //     $(".goodsCount div>i").text(_count)
    // })

    // 渲染列表
    var xhr = new XMLHttpRequest();
    xhr.open("get", "http://localhost:8000/home");
    xhr.onload = function () {
        var res = JSON.parse(xhr.response)
        render(res)
    }
    xhr.send();
    // 渲染左边栏菜单
    function render(res) {
        var leftItem = res.data;

        var list1goodsHtml = "";
        var count = 0;
        leftItem.forEach(ele => {
            count++;
            list1goodsHtml +=
                `
                <li>
                    <span>${ele.classifyName}</span>
                    <ul>
                `;
            var goodslist = ele.list;
            // console.log(ele.classifyName)
            goodslist.forEach(element => {
                // console.log(element.classifyName)
                list1goodsHtml +=
                    `
                    <li>
                        <a href="?${element.classifyId}">${element.classifyName}</a>
                    </li>
                `;
            });
            list1goodsHtml +=
                `   </ul>
                 </li>
                `
        });

        // 放入html中
        $(".detail_goodslist").append(list1goodsHtml);
        // 点击隐藏二级菜单
        $(".detail_goodslist li span").click(function () {
            $(this).siblings("ul").toggleClass(" detail__ListHide")
        })
    }

    // 自渲染商品细节图片
    ; +(function () {
        var detailGoodsRenderHtml = "";
        for (var i = 1; i < 27; i++) {
            detailGoodsRenderHtml +=
                `
                <div>
                    <img src="../../img/detail/detail${i}.jpg">
                </div>
                `
        }
        $(".detail_body_middle").append(detailGoodsRenderHtml);
        var _height = $(".detail_body_middle")
        // console.log(_height)
    })()

    // 渲染右边栏图片展示
    $.ajax({
        url: "http://localhost:8000/detail1",//json文件位置
        type: "GET",//请求方式为get
        dataType: "json", //返回数据格式为json
        success: function (res) {//请求成功完成后要执行的方法 
            var _json = res.data;
            var detail_rightHTML = "";
            _json.forEach(ele => {
                // console.log(ele.picurls[1])
                detail_rightHTML +=
                    `
                    <li>
                        <a href="?design=${ele.colorCode}"><img src="https://www.only.cn${ele.picurls[0]}"></a>
                        <span>￥${ele.price}</span>
                    </li>
                    `;
            })
            $(".detail_body_right ul").append(detail_rightHTML);

        }
    })

    // 整体渲染
    $.ajax({
        url: `http://localhost:8000/detail2${window.location.search}`,//json文件位置
        type: "GET",//请求方式为get
        dataType: "json", //返回数据格式为json
        success: function (res) {//请求成功完成后要执行的方法 
            console.log(res.data);
            var _class = res.data.color;
            var str1 = "";
            var str2 = "";
            var str3 = "";
            var str4 = "";
            var str5 = "";
            var str6 = "";
            $(".detail_main_title span").text(`首页/${res.data.goodsName}`)
            str1 +=
                `
                <li><img src="https://www.only.cn${_class[0].picurls[0]}"></li>
                <li><img src="https://www.only.cn${_class[0].picurls[1]}"></li>
                <li><img src="https://www.only.cn${_class[0].picurls[2]}"></li>
                <li><img src="https://www.only.cn${_class[0].picurls[3]}"></li>
                `;
            $(".magnifier_sm").append(str1);

            $(".magnifier_sm li").click(function () {
                $(this).addClass("chooseItem")
                    .css({
                        height: "170px"
                    })
                    .siblings().removeClass("chooseItem")
                    .css({
                        height: "172px"
                    })
                var _index = $(this).index()
                if (_index == 0) {
                    $(".magnifier_big img").attr("src", `https://www.only.cn${_class[0].picurls[0]}`);

                }
                if (_index == 1) {
                    $(".magnifier_big img").attr("src", `https://www.only.cn${_class[0].picurls[1]}`);

                }
                if (_index == 2) {
                    $(".magnifier_big img").attr("src", `https://www.only.cn${_class[0].picurls[2]}`);

                }
                if (_index == 3) {
                    $(".magnifier_big img").attr("src", `https://www.only.cn${_class[0].picurls[3]}`);

                }
            })

            str2 +=
                `
                        <span class="goods_price">价格</span>
                        <span class="goods_nowPrice">￥${_class[0].price}</span>
                        <span class="goods_lastPrice">吊牌价 ￥ ${_class[0].originalPrice}</span>
                        <i>5.0折</i>
                        `;
            $(".priceline").append(str2);
            str3 += `
                        <h3>${res.data.goodsName}</h3>
                        <p>产品编号:${_class[0].colorCode}</p>`;
            $(".detail_goodsInfo").prepend(str3);
            str4 +=
                `
                        <img src="https://www.only.cn${_class[0].picurls[0]}">
                        `
            $(".magnifier_big").prepend(str4)
            $(".magnifier_showpic").append(str4);

            res.data.color.forEach(ele => {
                str5 +=
                    `
                            <li>
                                <img src="https://www.only.cn${ele.picurls[1]}">
                                <span><img src="../../img/detail/rightlogo.png"></span>
                            </li>
                            `;
            });
            $(".goodsColor ul").append(str5)
            // 点击图片选择颜色
            var random_select = parseInt(Math.random() * 14 + 2)
            $(".goodsColor ul li").click(function () {
                $(this).addClass("chooseLogo").children("span").show().parent()
                    .siblings().removeClass("chooseLogo").children("span").hide();
                var _number = $(this).index();
                console.log(_number)
                // 显示库存
                $(".goodsCount p i").text(random_select + _number * 3);
                var _maxCount=$(".goodsCount p i").text();
                $(".goodsCount span").first().click(function () {
                    var _count = parseInt($(".goodsCount div>i").text());
                    if (_count < _maxCount){
                        _count++;
                    }
                    
                    $(".goodsCount div>i").text(_count)
                }).siblings().click(function () {
                    var _count = parseInt($(".goodsCount div>i").text());
                    if (_count > 1)
                        _count--;
                    $(".goodsCount div>i").text(_count)
                })
                str6 +=
                    `
                    <li><img src="https://www.only.cn${_class[_number].picurls[0]}"></li>
                    <li><img src="https://www.only.cn${_class[_number].picurls[1]}"></li>
                    <li><img src="https://www.only.cn${_class[_number].picurls[2]}"></li>
                    <li><img src="https://www.only.cn${_class[_number].picurls[3]}"></li>
                    `
                $(".magnifier_sm").empty()
                $(".magnifier_sm").append(str6);
                $(".magnifier_big>img").attr("src", `https://www.only.cn${_class[_number].picurls[0]}`);
                $(".magnifier_showpic>img").attr("src", `https://www.only.cn${_class[_number].picurls[0]}`)
                str6 = "";
                $(".magnifier_sm li").click(function () {
                    $(this).addClass("chooseItem")
                        .css({
                            height: "170px"
                        })
                        .siblings().removeClass("chooseItem")
                        .css({
                            height: "172px"
                        })
                    var _index1 = $(this).index()
                    if (_index1 == 0) {
                        $(".magnifier_big img").attr("src", `https://www.only.cn${_class[_number].picurls[0]}`);

                    }
                    if (_index1 == 1) {
                        $(".magnifier_big img").attr("src", `https://www.only.cn${_class[_number].picurls[1]}`);

                    }
                    if (_index1 == 2) {
                        $(".magnifier_big img").attr("src", `https://www.only.cn${_class[_number].picurls[2]}`);

                    }
                    if (_index1 == 3) {
                        $(".magnifier_big img").attr("src", `https://www.only.cn${_class[_number].picurls[3]}`);

                    }
                })
            });

        }

    })
</script>

</html>